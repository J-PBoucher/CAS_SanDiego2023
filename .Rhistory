geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("Relativity"="blue"))+
ylab("Relativity") + xlab("Claim-score") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
score.nbclaim <- as.formula(NbClaims ~ car_color + need_glasses + territory + language + food + offset(log(risk_expo)))
Poisson   <- glm(score.nbclaim, family=poisson(link=log), data=db.train)
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
coef <- as.numeric(Poisson.BMS$coefficients[9])
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text = element_text(size = 20))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text = element_text(size = 20))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE, size=20) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text = element_text(size = 20))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE, size=10) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE, size=10) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
axis.text = element_text(size = 20))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE, size=10) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE, size=10) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="red") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("BMS Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text = element_text(size = 15))
BMS.s    <- 104
BMS.min  <- 96
BMS.ell0 <- 100
BMS.psi  <- 2
min1 <- BMS.min
max1 <- BMS.s
#coef <- as.numeric(Poisson.BMS$coefficients[9])
coef <- 0.1180
nb <- floor(max1-min1 + 1)
rel.mat <- matrix(ncol=2, nrow=nb)
for(i in 1:nb){
BMS.level <- as.numeric(BMS.min - 1 + i)
rel.BMS <- exp((BMS.level-100)*coef)
rel.mat[i, 1] <- BMS.level
rel.mat[i, 2] <- rel.BMS
}
rel.mat.SI <- data.frame(rel.mat)
colnames(rel.mat.SI) <- c("BMS.level", "rel")
## calculs pour le graph ###
floor_dec <- function(x, level=1) round(x - 5*10^(-level-1), level)
ceiling_dec <- function(x, level=1) round(x + 5*10^(-level-1), level)
y.max <- max(rel.mat.SI$rel)
y.maxc <- ceiling_dec(y.max, 1)
y.min <- min(rel.mat.SI$rel)
y.minf <- floor_dec(y.min, 1)
x.loc.psi <- BMS.psi/2 + 100
y.loc.psi <- y.min + 0.06
y.psi <- exp(BMS.psi*coef)
y.kappa <- exp(-coef)
up <- 0.02
ggplot(rel.mat.SI) +
geom_line(aes(x=BMS.level, y = rel, colour="Relativity")) +
## maximum
#  geom_segment(x = BMS.s, xend=BMS.s, y = 0, yend=y.max, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.s, y = y.max , yend=y.max, colour = "blue", linetype="dashed",  size = 0.3) +
## minimum
#  geom_segment(x = BMS.min, xend=BMS.min, y = 0, yend=y.min, colour = "black", size = 0.3) +
geom_segment(x = 0, xend=BMS.min, y = y.min , yend=y.min, colour = "blue", linetype="dashed", size = 0.3) +
## relativite 1.00
geom_segment(x = 100, xend=100, y = 0, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100, y = 1, yend=1, colour = "black", linetype="dashed",size = 0.3) +
geom_point(aes(x=100, y=1), colour="black") +
## Claim + Psi
annotate("text", x = x.loc.psi, y = y.loc.psi, label = '+Psi', color="red", parse = TRUE, size=5) +
geom_segment(aes(x = 100, y = y.min + up, xend = 100+BMS.psi, yend = y.min + up), color="red", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 100 + BMS.psi, xend=100+ BMS.psi, y = 0, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=100 + BMS.psi, y = y.psi, yend=y.psi, colour = "red", linetype="dashed",size = 0.3) +
geom_point(aes(x=100+BMS.psi, y=y.psi), colour="red") +
## No Claim - 1
annotate("text", x = 99.4, y = y.loc.psi, label = '-1', color="darkgreen", parse = TRUE, size=5) +
geom_segment(aes(x = 100, y = y.min + up, xend = 99, yend = y.min + up), color="darkgreen", arrow = arrow(length = unit(0.5, "cm"))) +
geom_segment(x = 99, xend=99, y = 0, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_segment(x = 0, xend=99, y = y.kappa, yend=y.kappa, colour = "darkgreen", linetype="dashed",size = 0.3) +
geom_point(aes(x=99, y=y.kappa), colour="darkgreen") +
scale_colour_manual("", values = c("BMS Relativity"="blue"))+
ylab("Relativity") + xlab("Level") +
scale_x_continuous(breaks=c(seq(BMS.min,BMS.s,by=1), BMS.s)) +
scale_y_continuous(breaks=c(seq(y.minf,y.maxc,by=0.1))) +
theme(legend.position="none") +
theme(panel.grid.major = element_blank(), panel.grid.minor = element_blank(),
panel.background = element_blank(), axis.line = element_line(colour = "black"),
text = element_text(size = 15))
data <- set.BMS_levels(ell.max=104, ell.min=96, Psi=2, df2)
